# Main production configuration
# Manage active parsers via enabled_parsers
# For individual containers use --parser flag (fonbet/pinnacle)

# PostgreSQL for value bet history
# Yandex Cloud Managed PostgreSQL configuration
# 
# Production cluster info:
# - Hosts: rc1a-fec715cq0rept3kd.mdb.yandexcloud.net,rc1a-h8tc88gfbg9v7anh.mdb.yandexcloud.net
# - Port: 6432
# - User: vodeneevbet
# - Database: db (or your database name)
#
# For Yandex Cloud Managed PostgreSQL, use format:
# dsn: "host=<host1>,<host2> port=6432 user=<username> password=<password> dbname=<dbname> sslmode=require target_session_attrs=read-write"
# 
# Example for production (set via POSTGRES_DSN env var or GitHub Secrets):
# dsn: "host=rc1a-fec715cq0rept3kd.mdb.yandexcloud.net,rc1a-h8tc88gfbg9v7anh.mdb.yandexcloud.net port=6432 user=vodeneevm password=<your_password> dbname=db sslmode=require target_session_attrs=read-write"
# 
# For local development (docker-compose):
postgres:
  dsn: "host=localhost user=arb_user password=arb_password dbname=arb_db port=5432 sslmode=disable"
  # 
  # You can also set DSN via environment variable: POSTGRES_DSN

parser:
  # Production parser management
  # Empty array [] = run all registered parsers
  enabled_parsers: ["fonbet", "pinnacle", "pinnacle888"]
  
  interval: 15s  # Parsing interval (reduced for faster live match updates)
  user_agent: "ValueBetBot/1.0 (https://github.com/Vodeneev/vodeneevbet)"
  timeout: 120s
  headers:
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
    "Accept-Language": "ru-RU,ru;q=0.9,en;q=0.8"
    "Accept-Encoding": "gzip, deflate, br"
    "Connection": "keep-alive"
    "Upgrade-Insecure-Requests": "1"
  
  # Fonbet API settings
  fonbet:
    base_url: "https://line55w.bk6bba-resources.com/events/list"
    lang: "en"  # Use English to match Pinnacle team names for proper match merging
    version: "60312723953"
    test_limit: 0  # Event limit for testing (0 = no limit)

  # Pinnacle guest API (do not commit real keys)
  pinnacle:
    base_url: "https://guest.api.arcadia.pinnacle.com"
    api_key: ""        # can be set via ENV PINNACLE_API_KEY
    device_uuid: ""    # can be set via ENV PINNACLE_DEVICE_UUID
    matchup_ids: []    # example: [1621112306, 1621112308]
    # Proxy list for bypassing Cloudflare blocking
    # Client will try proxies in order until one works
    # Format: http://user:pass@ip:port or http://ip:port
    proxy_list:
      - "http://auiefusb:nw4x77i8vjje@142.111.48.253:7030"  # USA, Los Angeles
      - "http://auiefusb:nw4x77i8vjje@23.95.150.145:6114"   # USA, Buffalo
      - "http://auiefusb:nw4x77i8vjje@198.23.239.134:6540"  # USA, Buffalo
      - "http://auiefusb:nw4x77i8vjje@107.172.163.27:6543"  # USA, Bloomingdale
      - "http://auiefusb:nw4x77i8vjje@198.105.121.200:6462" # USA, Bloomingdale
      - "http://auiefusb:nw4x77i8vjje@64.137.96.74:6641"   # UK, London
      - "http://auiefusb:nw4x77i8vjje@84.247.60.125:6095"   # Spain, Madrid
      - "http://auiefusb:nw4x77i8vjje@216.10.27.159:6837"   # Poland, Warsaw
      - "http://auiefusb:nw4x77i8vjje@23.26.71.145:5628"     # USA, Dallas
      - "http://auiefusb:nw4x77i8vjje@23.27.208.120:5830"   # USA, Orem

  # Pinnacle888 guest API with mirror URL support
  pinnacle888:
    base_url: ""       # Optional: direct base URL (if mirror_url is not provided)
    mirror_url: "https://bit.ly/pinnacle_mirror"  # Mirror URL to resolve actual baseURL
    live_events_url: "https://www.frozensunset88.xyz/sports-service/sv/compact/events"  # URL for live events (compact format)
    line_events_url: "https://www.frozensunset88.xyz/sports-service/sv/compact/events"  # URL for pre-match/line events (compact format)
    api_key: ""        # can be set via ENV PINNACLE888_API_KEY
    device_uuid: ""    # can be set via ENV PINNACLE888_DEVICE_UUID
    matchup_ids: []    # example: [1621112306, 1621112308]
    include_live: true  # Include live matches (default: false)
    include_prematch: true  # Include pre-match/line matches (default: false)
    # Proxy list for bypassing Cloudflare blocking
    # Client will try proxies in order until one works
    # Format: http://user:pass@ip:port or http://ip:port
    proxy_list: []    # Can reuse pinnacle proxy_list if needed

value_calculator:
  # Value Bet settings
  reference_method: "average_top5"  # "pinnacle" or "average_top5"
  max_risk_percent: 5.0            # Maximum risk
  min_stake: 1000                  # Minimum stake
  max_stake: 50000                 # Maximum stake
  check_interval: 5m               # Check interval
  test_interval: 30s               # Test interval
  
  # Data source: use parser's /matches endpoint
  parser_url: "http://158.160.197.172/parser"  # URL to parser service (e.g. "http://parser:8080" in Docker)
  
  # Filters
  sports: ["football"]             # Football only
  markets: ["1x2", "total", "handicap"]  # Main markets
  
  # Note: For value bets calculation, we use ALL bookmakers with weighted average
  
  # Bookmaker weights for weighted average calculation (optional)
  # Higher weight = more influence on fair probability calculation
  # Default: 1.0 for all bookmakers if not specified
  bookmaker_weights:
    pinnacle: 1.0      # Reference bookmaker - maximum weight
    betfair: 0.95
    sbobet: 0.9
    bet365: 0.85
    williamhill: 0.8
    pinnacle888: 0.7   # New bookmaker - lower weight
  
  # Minimum value percent to show value bets (default: 5.0)
  min_value_percent: 5.0
  
  # Async processing settings
  async_enabled: true              # Enable asynchronous processing
  async_interval: 30s              # Interval for async processing (every 30 seconds)
  alert_threshold: 30.0            # Send Telegram alerts only for diffs >= 30%
  # Deprecated (kept for backward compatibility; not used when alert_threshold is set):
  alert_threshold_10: 0.0
  alert_threshold_20: 0.0
  telegram_bot_token: ""          # Telegram bot token (set via TELEGRAM_BOT_TOKEN env var)
  telegram_chat_id: 0              # Telegram chat ID to send notifications (set via TELEGRAM_CHAT_ID env var)
